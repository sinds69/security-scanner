<!DOCTYPE html> <html lang="id"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"> <title>Watermark Hotel - Security Checklist</title> <script src="https://unpkg.com/html5-qrcode"></script> <style> * { margin: 0; padding: 0; box-sizing: border-box; } html, body { width: 100%; height: 100%; overflow: hidden; } body { font-family: Arial, sans-serif; background: #0f172a; color: white; display: flex; flex-direction: column; justify-content: space-between; align-items: center; text-align: center; height: 100svh; } .header { margin-top: 30px; } h1 { font-size: 34px; } h2 { font-size: 26px; font-weight: normal; opacity: 0.8; } .content { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; } .scan-btn { background: #22c55e; color: #022c22; font-size: 22px; padding: 28px; border-radius: 15px; border: none; width: 85%; max-width: 320px; cursor: pointer; } #reader { width: 90%; max-width: 320px; margin-top: 15px; display: none; } #reader video { object-fit: cover; } .footer { font-size: 12px; opacity: 0.6; padding-bottom: 10px; } </style> </head> <body> <div class="header"> <h1>Watermark Hotel</h1> <h2>Security Checklist</h2> </div> <div class="content"> <button class="scan-btn" onclick="startScan()">Tap Here to Scan QR</button> <div id="reader"></div> </div> <div class="footer"> Â© Copyright by SIN </div> <script> let locked = false; let qrInstance; let videoStream; /* ENTRY POINT */ function startScan() { document.getElementById("reader").style.display = "block"; if ('BarcodeDetector' in window) { startNativeScanner(); } else { startHtml5Scanner(); } } /* ===== NATIVE BARCODE DETECTOR (Chrome Android) ===== */ async function startNativeScanner() { try { const reader = document.getElementById("reader"); reader.innerHTML = ""; const video = document.createElement("video"); video.setAttribute("playsinline", true); reader.appendChild(video); videoStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } }); video.srcObject = videoStream; await video.play(); const detector = new BarcodeDetector({ formats: ["qr_code"] }); const scanLoop = async () => { if (locked) return; const codes = await detector.detect(video); if (codes.length > 0) { locked = true; stopStream(); redirect(codes[0].rawValue); } else { requestAnimationFrame(scanLoop); } }; scanLoop(); } catch (e) { console.error("Native scanner gagal, fallback", e); startHtml5Scanner(); } } /* ===== FALLBACK HTML5-QRCODE ===== */ function startHtml5Scanner() { qrInstance = new Html5Qrcode("reader"); qrInstance.start( { facingMode: "environment" }, { fps: 5, aspectRatio: 1.0 }, (text) => { if (locked) return; locked = true; qrInstance.stop().then(() => { redirect(text); }); }, () => {} ); } /* ===== UTIL ===== */ function redirect(text) { if (!text.startsWith("http://") && !text.startsWith("https://")) { text = "https://" + text; } window.location.replace(text); } function stopStream() { if (videoStream) { videoStream.getTracks().forEach(t => t.stop()); } } </script> </body> </html>
